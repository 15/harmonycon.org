---
import { Image, getImage } from "astro:assets";
import Layout from "../layouts/Layout.astro";

import { Icon } from "astro-icon/components";

import cocBackground from "../assets/2025/bg/vendorhall.png";
const optimizedCocBackground = await getImage({
  src: cocBackground,
  format: "avif",
  width: 2000,
});


import vendor from "../assets/2025/vendors/dealers_room.png";

import vendors from "@data/vendors.js";

const optimizedVendor = await getImage({
  src: vendor,
  format: "avif",
  width: 1080,
});

import table1 from "../assets/2025/vendors/dealers_room/0.png";
import table2 from "../assets/2025/vendors/dealers_room/1.png";
import table3 from "../assets/2025/vendors/dealers_room/2.png";
import table4 from "../assets/2025/vendors/dealers_room/3.png";
import table5 from "../assets/2025/vendors/dealers_room/4.png";
import table6 from "../assets/2025/vendors/dealers_room/5.png";
import table7 from "../assets/2025/vendors/dealers_room/6.png";
import table8 from "../assets/2025/vendors/dealers_room/7.png";
import table9 from "../assets/2025/vendors/dealers_room/8.png";
import table10 from "../assets/2025/vendors/dealers_room/9.png";
import table11 from "../assets/2025/vendors/dealers_room/10.png";
import table12 from "../assets/2025/vendors/dealers_room/11.png";
import table13 from "../assets/2025/vendors/dealers_room/12.png";
import table14 from "../assets/2025/vendors/dealers_room/13.png";
import table15 from "../assets/2025/vendors/dealers_room/14.png";
import table16 from "../assets/2025/vendors/dealers_room/15.png";
import table17 from "../assets/2025/vendors/dealers_room/16.png";
import table18 from "../assets/2025/vendors/dealers_room/17.png";
import table19 from "../assets/2025/vendors/dealers_room/18.png";
import table20 from "../assets/2025/vendors/dealers_room/19.png";
import table21 from "../assets/2025/vendors/dealers_room/20.png";
import table22 from "../assets/2025/vendors/dealers_room/21.png";
import table23 from "../assets/2025/vendors/dealers_room/22.png";
import table24 from "../assets/2025/vendors/dealers_room/23.png";
import table25 from "../assets/2025/vendors/dealers_room/24.png";
import table26 from "../assets/2025/vendors/dealers_room/25.png";
import table27 from "../assets/2025/vendors/dealers_room/26.png";
import table28 from "../assets/2025/vendors/dealers_room/27.png";
import table29 from "../assets/2025/vendors/dealers_room/28.png";
import table30 from "../assets/2025/vendors/dealers_room/29.png";
import table31 from "../assets/2025/vendors/dealers_room/30.png";
import table32 from "../assets/2025/vendors/dealers_room/31.png";
import table33 from "../assets/2025/vendors/dealers_room/32.png";
import table34 from "../assets/2025/vendors/dealers_room/33.png";
import table35 from "../assets/2025/vendors/dealers_room/34.png";
import table36 from "../assets/2025/vendors/dealers_room/35.png";
import table37 from "../assets/2025/vendors/dealers_room/36.png";
import table38 from "../assets/2025/vendors/dealers_room/37.png";
import table39 from "../assets/2025/vendors/dealers_room/38.png";
import table40 from "../assets/2025/vendors/dealers_room/39.png";
import table41 from "../assets/2025/vendors/dealers_room/40.png";
import table42 from "../assets/2025/vendors/dealers_room/41.png";
import table43 from "../assets/2025/vendors/dealers_room/42.png";

const tables = [
  table1,
  table2,
  table3,
  table4,
  table5,
  table6,
  table7,
  table8,
  table9,
  table10,
  table11,
  table12,
  table13,
  table14,
  table15,
  table16,
  table17,
  table18,
  table19,
  table20,
  table21,
  table22,
  table23,
  table24,
  table25,
  table26,
  table27,
  table28,
  table29,
  table30,
  table31,
  table32,
  table33,
  table34,
  table35,
  table36,
  table37,
  table38,
  table39,
  table40,
  table41,
  table42,
  table43
]

import Footer from "../components/Footer.astro";
---

<Layout title="HarmonyCon 2025 | Vendors">
  <div id="bg" class="flex md:flex-row flex-col justify-center items-center">
    <div
      class="text-black bg-white flex flex-col lg:flex-row items-center rotate-0 rounded w-[95%] md:w-[95%] lg:w-[95%] xl:w-[95%] 2xl:w-[50%] lg:aspect-[0.829] h-auto"
      style={`filter: drop-shadow(0 5px 5px #000); background-image: url(${optimizedVendor.src}); background-size: contain; 
      background-repeat: no-repeat;`}
    >
        {
          vendors.map(({ id, left, top, width, height }, i) => (
              <Image id={`table-${i+1}`} format="avif" src={tables[i]} width={800} alt={`Table #${i+1}`} class={`w-full absolute highlight-orange z-0 opacity-0 duration-300`}/> 
              <div
                id={`regular-${id}`}
                style={`left: ${left}%; top: ${top}%; width: ${width}%; height: ${height}%;`}
                class={`bg-transparent opacity-50 table z-50`}
              >
                
              </div>
          ))
        }
    <!-- <div class="my-8 lg:mt-16 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 2xl:grid-cols-3 justify-center w-full xl:px-0 px-2 xl:w-5/6 2xl:w-4/5 gap-8 ">
      {
        vendors.map(({id, name, src, desc, selling }) =>
          <div id={`card-${id}`} class="relative cursor-pointer group hover:bg-orange-500 hover:text-white duration-300 w-full bg-[#fcf1e0] rounded p-8 flex flex-col" style="filter: drop-shadow(0 10px 10px #000); ">
            <div class="flex justify-between mb-4 items-center">
              <div class="text-3xl md:text-3xl lg:text-4xl font-bold uppercase ">{name}</div>
              <div id="vendor-pfp" style={`background-image: url(/pfp/${src});`} class="bg-cover bg-center aspect-square h-14 md:h-14 lg:h-14 xl:h-16 2xl:h-20 border border-black bg-transparent">

              </div>
            </div>
            
            <hr class="border-2 border-black group-hover:border-white duration-300 mb-4"/>
            
            <div class="italic leading-snug text-sm md:text-sm lg:text-base mb-4" set:html={desc}> 
            </div>

            <div class="px-0 text-xs md:text-xs lg:text-sm italic mb-1">This vendor will be selling:</div>
            <ul class='px-4 text-base mb-12'>
              {
                selling.map(item => <li class='my-0.5 text-xs md:text-xs lg:text-sm uppercase font-medium px-2 border-b-2 block border-black group-hover:border-white '>{item}</li>)
              }
            </ul>
            <div class="font-semibold absolute bottom-0 text-center left-0 right-0 mx-auto w-full mb-8 lg:mb-4 text-sm">
              Click this card see this vendor's location!
            </div>
          </div>
        )
      }
    </div> -->
    </div>
    <Footer />
  </div>

  <style
    define:vars={{
      optimizedCocBackground: `url(${optimizedCocBackground.src})`,
    }}
  >

.table {
    @apply text-center flex items-center  justify-center cursor-pointer  absolute;
  }

  .grayscale {
        filter: brightness(60%) grayscale(100) hue-rotate(0deg);
      }

      .highlight-orange {
        filter: invert(21%) sepia(13%) saturate(4615%) hue-rotate(335deg)
          brightness(97%) contrast(89%) drop-shadow(0 3px 3px #000);
      }

      .highlight-green {
        filter: invert(47%) sepia(56%) saturate(559%) hue-rotate(36deg)
          brightness(103%) contrast(87%) drop-shadow(0 3px 3px #000);
      }


    :root {
      --elastic: linear(
        0,
        0.0009 8.51%,
        -0.0047 19.22%,
        0.0016 22.39%,
        0.023 27.81%,
        0.0237 30.08%,
        0.0144 31.81%,
        -0.0051 33.48%,
        -0.1116 39.25%,
        -0.1181 40.59%,
        -0.1058 41.79%,
        -0.0455,
        0.0701 45.34%,
        0.9702 55.19%,
        1.0696 56.97%,
        1.0987 57.88%,
        1.1146 58.82%,
        1.1181 59.83%,
        1.1092 60.95%,
        1.0057 66.48%,
        0.986 68.14%,
        0.9765 69.84%,
        0.9769 72.16%,
        0.9984 77.61%,
        1.0047 80.79%,
        0.9991 91.48%,
        1
      );

      --sine: linear(
        0,
        0.007 5.35%,
        0.0282 10.75%,
        0.0638 16.26%,
        0.1144 21.96%,
        0.1833 28.16%,
        0.2717 34.9%,
        0.6868 62.19%,
        0.775 68.54%,
        0.8457 74.3%,
        0.9141 81.07%,
        0.9621 87.52%,
        0.9905 93.8%,
        1
      );
    }
    #bg {
      position: absolute;

      top: 0;
      left: 0;
      width: 100%;
      height: auto;
      min-height: 100%;
      background-image: var(--optimizedCocBackground);
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;
      opacity: 1;
    }

    .card1 {
      animation:
      /* reveal 0.7s cubic-bezier(0.5, 0.1, 0.1, 1) 0.6s forwards,
      zoom 0.75s ease-out 0.6s forwards, */ floating1
        4s var(--sine) 0s infinite forwards;
    }

    .card2 {
      animation:
      /* reveal 0.7s cubic-bezier(0.5, 0.1, 0.1, 1) 0.8s forwards,
      zoom 0.75s ease-out 0.9s forwards, */ floating2
        5s var(--sine) 0.4s infinite forwards;
    }

    .card3 {
      animation:
      /* reveal 0.7s cubic-bezier(0.5, 0.1, 0.1, 1) 1s forwards,
      zoom 0.75s ease-out 1.2s forwards, */ floating3
        4.5s var(--sine) 0.8s infinite forwards;
    }

    @keyframes reveal {
      from {
        /* bottom: -150vh; */
        opacity: 1;
        transform: translateY(-300%);
      }
      to {
        opacity: 1;
        transform: translateY(0%);
      }
    }
    @keyframes zoom {
      from {
        rotate: 10deg;
        scale: 1;
      }
      to {
        rotate: -0.3deg;
        scale: 1;
      }
    }

    @keyframes floating1 {
      0% {
        translate: 0px 0px;
      }
      50% {
        translate: 0px 6px;
      }
      100% {
        translate: 0px 0px;
      }
    }

    @keyframes floating2 {
      0% {
        translate: 0px 0px;
      }
      50% {
        translate: 0px -6px;
      }
      100% {
        translate: 0px 0px;
      }
    }

    @keyframes floating3 {
      0% {
        translate: 0px 0px;
      }
      50% {
        translate: 0px 5px;
      }
      100% {
        translate: 0px 0px;
      }
    }
  </style>
</Layout>



<script define:vars={{ vendors }}>
  const trigger = () => {
    const ad = document.getElementById("ad");
    if (window.innerWidth <= 1280 && ad) {
      window.addEventListener('scroll', () => {
        const appear = 20;
        if (window.pageYOffset <= appear) {
          // If more show the element
          ad.style.opacity = '1'
          ad.style.pointerEvents = 'all'
        } else {
          // Else hide it
          ad.style.opacity = '0'
          ad.style.pointerEvents = 'none'
        }
      });
    }

    let activeID = '';
    vendors.forEach(({id}) => {
      if (document.getElementById(`regular-${id}`)) {
        const highlight = () => {
          if (activeID) {
            const prevTable = document.getElementById(`table-${activeID}`);
            if (prevTable) {
              prevTable.style.opacity = '0';
            }
          }
          const currentTable = document.getElementById(`table-${id}`);
          if (currentTable) {
            currentTable.style.opacity = '1';
          }
          activeID = id;
        };
        
        document.getElementById(`regular-${id}`)?.addEventListener("mouseenter", highlight);
      }
    });
  };

  trigger();
</script>