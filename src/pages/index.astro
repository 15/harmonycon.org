---
import { Image, getImage } from "astro:assets";
import { Icon } from "astro-icon/components";
import Layout from "../layouts/Layout.astro";
import Footer from "../components/Footer.astro";

import curtains1 from "../assets/2025/curtain_full.png";
const optimizedCurtains1 = await getImage({
  src: curtains1,
  format: "webp",
  width: 2000,
});

import indexBackground from "../assets/2025/teaser.png";
const optimizedIndexBackground = await getImage({
  src: indexBackground,
  format: "webp",
  width: 2000,
});
---

<Layout title="HarmonyCon 2025">
  <div id="curtains" class="z-40 overflow-hidden">
    <div id="curtain-1"></div>
    <div id="curtain-2"></div>
  </div>
  <div id="mask" class="mask"></div>
  <div
    class="opacity-0 z-[100] absolute top-4 left-1/2 transform -translate-x-1/2 md:left-auto md:translate-x-0 md:top-4 md:right-4 text-3xl cursor-pointer p-2 hover:bg-neutral-200 duration-500 rounded hover:text-black"
    id="sound"
  >
    <Icon name="charm:sound-up" id="sound-on" class="block" />
    <Icon name="charm:sound-mute" id="sound-off" class="hidden" />
  </div>
  <div
    class="absolute bottom-24 left-1/2 transform -translate-x-1/2 md:left-auto md:translate-x-0 md:bottom-16 md:right-16 text-3xl md:text-3xl font-serif opacity-0 text-white"
    id="count"
  >
    1
  </div>
  <div
    class="absolute bottom-20 left-1/2 transform -translate-x-1/2 md:left-auto md:translate-x-0 md:bottom-24 md:right-16 text-base md:text-2xl font-serif opacity-0 text-yellow-200"
    id="boopcount"
  >
    1
  </div>
  <div
    id="dialogue"
    class="z-[60] text-black absolute bottom-36 md:bottom-12 md:w-240 bg-neutral-300 opacity-0 left-0 right-0 md:mx-auto mx-2 rounded px-6 py-6 md:px-8 md:py-8"
  >
    <div class="font-semibold text-2xl md:text-3xl">Harmonic Tune</div>
    <div class="text-base md:text-xl italic leading-tight" id="text">
      Howdy! We're closed right now. Please come back later!
    </div>
  </div>
  <div
    id="snoot"
    class="z-50 bg-transparent hidden absolute w-24 h-24 md:w-40 md:h-40 left-[60%] bottom-[47%] sm:left-[45%] md:left-[13%] lg:left-[20%] xl:left-[24%] 2xl:left-[30%] md:bottom-[45%]"
  >
  </div>
  <Footer />
</Layout>

<script src="../scripts/min.js"></script>
<!-- <script src="../scripts/main.js"></script> -->

<style
  lang="scss"
  define:vars={{
    optimizedIndexBackground: `url(${optimizedIndexBackground.src})`,
    optimizedCurtains1: `url(${optimizedCurtains1.src})`,
  }}
>
  :root {
    --sine: linear(
      0,
      0.007 5.35%,
      0.0282 10.75%,
      0.0638 16.26%,
      0.1144 21.96%,
      0.1833 28.16%,
      0.2717 34.9%,
      0.6868 62.19%,
      0.775 68.54%,
      0.8457 74.3%,
      0.9141 81.07%,
      0.9621 87.52%,
      0.9905 93.8%,
      1
    );

    --mouse-x: 50%;
    --mouse-y: 50%;
    --radius: 120px;
  }

  .mask {
    width: 100vw;
    height: 100vh;
    background-color: hsla(0, 0%, 0%, 1);
  }
  .mask2 {
    mask: radial-gradient(
      circle at var(--mouse-x) var(--mouse-y),
      transparent 20px,
      black var(--radius)
    );
    -webkit-mask: radial-gradient(
      circle at var(--mouse-x) var(--mouse-y),
      transparent 20px,
      black var(--radius)
    );
  }

  .fade-immediate {
    opacity: 0;
    animation: fadeIn 2s cubic-bezier(0.77, 0.01, 0.25, 1) 0s forwards;
  }

  @keyframes fadeIn {
    0% {
      opacity: 0;
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 1;
    }
  }

  #curtains {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
  #curtain-1,
  #curtain-2 {
    content: "";
    display: block;
    width: 50%;
    height: 100%;
    background-color: #000;
  }

  #curtain-1 {
    position: absolute;
    left: 0;
    top: 0;
    transform: translateX(-100%);
    animation-name: slide-left;
    animation-duration: 1.2s;
    animation-delay: 0s;
    animation-direction: alternate;
    background-image: var(--optimizedCurtains1);
    background-size: cover;
  }

  #curtain-2 {
    position: absolute;
    right: 0;
    top: 0;
    transform: translateX(100%);
    animation-name: slide-right;
    animation-duration: 1.2s;
    animation-delay: 0s;
    animation-direction: alternate;
    background-image: var(--optimizedCurtains1);
    background-size: cover;
  }

  @keyframes slide-left {
    0%,
    40% {
      transform: translateX(0%);
    }
    100% {
      transform: translateX(-100%);
    }
  }

  @keyframes slide-right {
    0%,
    40% {
      transform: translateX(0%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  .fade {
    opacity: 0;
    animation: fadeIn 2s cubic-bezier(0.77, 0.01, 0.25, 1) 1.5s forwards;
  }
  body.fade-to-white::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    opacity: 0;
    z-index: 9999; /* Make sure it's on top of everything else */
    animation: fadeToWhite 5s forwards;
  }

  @keyframes fadeToWhite {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
</style>
